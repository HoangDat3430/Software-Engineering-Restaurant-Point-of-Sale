<!doctype html>
<html lang="en">
<head>
    <meta charset="urf-8">
    <meta name="viewpoint" content="width=device-width, initial-scale=1">
    <!--bootstrap CSS-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="{% static 'checkoutform.css' %}"> -->
    <title> POS sytem </title>
</head>

<body>
    <div class="bg-dark p-3">
        <div class="row mx-0 pb-3 bg-light">
            <div class="col-sm-8">
                <p>
                    Order
                    <small, class="text-muted" id = "date"></small>
                </p>
                <div class="card rounded-3 mb-3">
                    <div class="card-body">
                        <ul class="nav nav-pills" id="pills-tab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active rounded-pill" id="pills-food-tab" data-bs-toggle="pill" data-bs-target="#pills-food" type="button" role="tab" aria-controls="pills-food" aria-selected="true">PIZZA</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link rounded-pill" id="pills-drink-tab" data-bs-toggle="pill" data-bs-target="#pills-drink" type="button" role="tab" aria-controls="pills-drink" aria-selected="false">DRINK</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link rounded-pill" id="pills-hamburger-tab" data-bs-toggle="pill" data-bs-target="#pills-hamburger" type="button" role="tab" aria-controls="pills-hamburger" aria-selected="false">HAMBURGER</button>
                            </li>
                            <li class="nav-item d-none" role="presentation">
                                <button class="nav-link rounded-pill" id="pills-checkout-tab" data-bs-toggle="pill" data-bs-target="#pills-checkout" type="button" role="tab" aria-controls="pills-checkout" aria-selected="false">CHECK OUT</button>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-food" role="tabpanel" aria-labelledby="pills-food-tab">
                        <div class="row row-cols-1 row-cols-md-4 g-4" id="Pizzatab">
                            
                        </div>
                    </div>
                    <div class="tab-pane fade" id="pills-drink" role="tabpanel" aria-labelledby="pills-profile-tab">
                        <div class="row row-cols-1 row-cols-md-4 g-4" id="Drinktab">
                                
                        </div>
                    </div>
                    <div class="tab-pane fade" id="pills-hamburger" role="tabpanel" aria-labelledby="pills-hamburger-tab">
                        <div class="row row-cols-1 row-cols-md-4 g-4" id="Hamburgertab">
                            
                        </div>
                    </div>
                    
                </div>
                </div>
            <div class="col-sm-4">
                <div class="card">
                    
                    <div class="card-body">
                        <h5 class="d-flex justify-content-between align-items-center"><span> Order </span><button onclick="clearorder()" class="btn btn-sm btn-danger rounded-pill">Clear</button></h5>
                        <hr>
                        <ul id="orderlist" class="list-unstyled" style="height: 50vh; overflow-y: auto;">
                        </ul>
                        <hr>
                        <ul class="list-unstyled mb-0">
                            <li class="d-flex justify-content-between align-items-center">
                                <big>Total Item: </big><big class="fw-bold"><span id="totalitem" class="card-text">0</span></big>
                            </li>
                            <li class="d-flex justify-content-between align-items-center">
                                <big>Total Amount: </big><big class="fw-bold">$ <span id="totalcost" class="card-text" >0.00</span></big>
                            </li>
                            <li>
                                <button disabled="" id="checkoutbutton" onclick=" passValues()" class="btn btn-primary btn-lg w-100 rounded-pill">CHECK OUT</button>
                            </li>
                            
                        </ul>
                        </li>
                    </div>
                </div>
            </div>

            <div class="modal_container_K" id="modal_container_K">
                <div class="modal_K"> 
                    <div class="tab-pane fade" id="pills-checkout" role="tabpanel" aria-labelledby="pills-checkout-tab"></div>
                        <h1>Check out</h1>
                        <div class="row mb-3">
                            <label for="colFormLabelLg" class="col-sm-4  col-form-label col-form-label-lg">Customer's Name</label>
                            <div class="col-sm-8">

                                <div class="row g-3">
                                    <div class="col">
                                    <input type="text" class="rounded-pill form-contro form-control-lg" placeholder="First name" aria-label="First name" id="fn">
                                    </div>
                                    <div class="col">
                                    <input type="text" class="rounded-pill form-contro form-control-lg" placeholder="Last name" aria-label="Last name" id="ln">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="colFormLabelLg" class="col-sm-4  col-form-label col-form-label-lg">Telephone's number</label>
                            <div class="col-sm-8">
                                <input type="tel" class="rounded-pill form-contro form-control-lg" id="telephonenumber" placeholder="phone">
                            </div>
                        </div>
                        <!--Amount of order-->
                        <div class="row  mb-3">
                            <label for="colFormLabelLg" class="col-sm-4  col-form-label col-form-label-lg">Total of amount($)</label>
                            <div class="col-sm-8">
                                <input type="number" step="0.01" class="rounded-pill form-contro l form-control-lg text-center" style="border:none; background: none;" id="amount" name="amount" placeholder="amount" disabled>
                            </div>
                        </div>
                        <!--Note-->
                        <div class="row  mb-3">
                            <label for="colFormLabelLg" class="col-sm-4  col-form-label col-form-label-lg">Note for this order</label>
                            <div class="col-sm-8">
                                <div class="form-floating">
                                    <textarea class="form-control" placeholder="Leave a comment here" id="floatingTextarea2" style="height: 100px"></textarea>
                                    <label for="floatingTextarea2">Note</label>
                                </div>
                            </div>
                        </div>
                        <!--Payment button-->
                        <li>
                            <form action="./payment.html" method="post">
                                <button type="submit" class="btn btn-primary btn-lg w-100 rounded-pill" onclick="passValues();" >Payment</button>
                            </form>
                        </li>
                        <li>
                            <form>
                                <button id="closecheckout" type="submit" onclick="passValues();" class="btn btn-primary btn-lg w-100 rounded-pill">Cancel checkout</button>
                            </form>
                        </li>
                    </div>
                </div>
            </div>


        </div>
    </div>
    <!-- Button trigger modal -->
    <!-- Modal -->
    <div class="modal fade" id="detailfood" tabindex="-1" aria-labelledby="" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-light text-dark">
            <h5 class="modal-title" id="exampleModalLabel">ADD TO CART</h5>
            <button type="button" class="btn-close" style ="background-color: bisque;" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class = "container" id="clickCard"></div>
            </div>
        </div>
        </div>
    </div>

    <script>
        const arrquantity = [];
        const orderidarray = [];
        const orderpricearray = [];
        const orderitemarray = [];
        const orderarray = [];
        const orderimgarray = [];
        const orderitemidarray = [];
        let id = 0;
        const  handleData = async ()=>{
            const response = await fetch('https://626a3d5f737b438c1c444612.mockapi.io/Pizza');
            const myJson = await response.json();

            const html = myJson.map((items) =>{

            return `
            <div class="col">
                                <div class="card h-100" style="width:200px;height:200px;">
                                    <img src="/media/${items.image}" class="card-img-top" alt="..." style="width:200px;height:200px;">
                                    <div class="card-body flex-row">
                                        <h5 class="card-title"><b>${items.name}</b></h5>
                                        <p class="card-text">
                                            <h5 class="d-flex justify-content-between align-items-center">
                                                <span> <p class="card-text"><b><font color="red">$${items.price}</font></b></p></span>
                                                <button type="button"  onclick="userAction('${items.image}',${items.id},'${items.name}','${items.price}',${items.protein},${items.addictives},${items.baking},${items.deco}, 'Pizza')" class="btn btn-primary rounded pid" style = "background-color: blue; text-align: left;" data-bs-toggle="modal" data-bs-target="#detailfood">
                                                    <img src = "./media/cart.png" style="width:20px;height:20px">
                                                </button>
                                            </h5>
                                        </p>
                                    </div>
                                </div>
                            </div>
            `;
                        }).join(" ");
            let a = document.querySelector("#Pizzatab");
            a.innerHTML = html;          
        };
         handleData();

            const  handleDataDrink = async ()=>{
            const response = await fetch('http://127.0.0.1:8000/drink/');
            const myJson = await response.json();
            const html = myJson.map((items) =>{
            return `
            <div class="col">
                                <div class="card h-100" style="width:200px;height:200px;">
                                    <img src="/media/${items.image}" class="card-img-top" alt="..." style="width:200px;height:200px;">
                                    <div class="card-body flex-row">
                                        <h5 class="card-title"><b>${items.name}</b></h5>
                                        <p class="card-text">
                                            <h5 class="d-flex justify-content-between align-items-center">
                                                <span> <p class="card-text"><b><font color="red">$${items.price}</font></b></p></span>
                                                <button type="button"  onclick="userAction('${items.image}',${items.id},'${items.name}','${items.price}',${items.protein},${items.addictives},${items.baking},${items.deco}, 'Drink')" class="btn btn-primary rounded pid" style = "background-color: blue; text-align: left;" data-bs-toggle="modal" data-bs-target="#detailfood">
                                                    <img src = "./media/cart.png" style="width:20px;height:20px">
                                                </button>
                                            </h5>
                                        </p>
                                    </div>
                                </div>
                            </div>
            `;
                        }).join(" ");
            let a = document.querySelector("#Drinktab");
            a.innerHTML = html;
                
            };
        handleDataDrink();
        const  handleDataHamburger = async ()=>{
            const response = await fetch('http://127.0.0.1:8000/hamburger/');
            const myJson = await response.json();
            const html = myJson.map((items) =>{
            return `
            <div class="col">
                                <div class="card h-100" style="width:200px;height:200px;">
                                    <img src="./media/${items.image}" class="card-img-top" alt="..." style="width:200px;height:200px;">
                                    <div class="card-body flex-row">
                                        <h5 class="card-title"><b>${items.name}</b></h5>
                                        <p class="card-text">
                                            <h5 class="d-flex justify-content-between align-items-center">
                                                <span> <p class="card-text"><b><font color="red">$${items.price}</font></b></p></span>
                                                <button type="button"  onclick="userAction('${items.image}',${items.id},'${items.name}','${items.price}',${items.protein},${items.addictives},${items.baking},${items.deco}, 'Hamburger')" class="btn btn-primary rounded pid" style = "background-color: blue; text-align: left;" data-bs-toggle="modal" data-bs-target="#detailfood">
                                                    <img src = "./media/cart.png" style="width:20px;height:20px">
                                                </button>
                                            </h5>
                                        </p>
                                    </div>
                                </div>
                            </div>
            `;
                        }).join(" ");
            let a = document.querySelector("#Hamburgertab");
            a.innerHTML = html;
                
 };
                handleDataHamburger();
        const userAction = async (ImageLink,id,Name,Price,Protein,Addictives,BakingMaterial,FoodDeco, catagory) => {
            document.getElementById('clickCard').innerHTML=
            `<div class = "row">
                        <div class = "col-4">
                            <!--test form-->
                            <img src="./media/`+ImageLink+`" class="img-thumbnail" alt="...">
                        </div>
                        <div class = "col-8">
                            <div>
                                <div class="d-flex bd-highlight mb-3">
                                    <div class="p-2 bd-highlight fs-5">SKU</div>
                                    <div class="p-2 bd-highlight fs-5">`+catagory+`<!--put id tag in here--></div>
                                    <div class="ms-auto p-2 bd-highlight fs-5">Unit Price</div>
                                </div>
                                <div class="d-flex bd-highlight mb-3">
                                    <div class="p-2 bd-highlight fs-6">`+id+`<!--put id card in here--></div>
                                    <div class="p-2 bd-highlight fs-6">`+Name+`<!--put id.name tag in here--></div>
                                    <div class="ms-auto p-2 bd-highlight fs-6">$`+Price+`<!--put id.price tag in here--></div>
                                </div>
                            </div>
                            <hr>
                            <p class="card-text">
                                <h5 class="d-flex justify-content-between align-items-center">
                                    <span> <p class="card-text"><b>Quantity</b></p></span>
                                    <div class="number">
                                        <button class = "rounded-pill" style="margin-left: 36px; margin-bottom: 5px; margin-right: 10px;" onclick="decrease(this)">-</button>
                                        <span class="value">1</span>
                                        <button class = "rounded-pill" onclick="increase(this)" style="margin-left: 10px;">+</button>
                                    </div>
                                </h5>
                            </p>
                            <hr>
                            <p class="fw-bold">Protein: `+Protein+`</p>
                            <p class="fw-bold">Additives: `+Addictives+`</p>
                            <p class="fw-bold">Baking material: `+BakingMaterial+`</p>
                            <p class="fw-bold">Food decoration: `+FoodDeco+`</p>
                            <p class="fs-4 fw-bold ">Size</p>
                            <p class="fs-6 fst-italic fw-lighter">Please select one of the size below</p>
                            <div class="form-check">
                                <input class="form-check-input" style="background-color: blue;" type="checkbox" value="" id="flexCheckDefaultS">
                                <label class="form-check-label" for="flexCheckDefaultS">
                                    Size S (6 inch)
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" style="background-color: blue;" type="checkbox" value="" id="flexCheckDefaultM">
                                <label class="form-check-label" for="flexCheckDefaultM">
                                    Size M (9 inch)
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" style="background-color: blue;" type="checkbox" value="" id="flexCheckDefaultL">
                                <label class="form-check-label" for="flexCheckDefaultL">
                                    Size L (12 inch)
                                </label>
                            </div> 
                            <hr>
                            <p class="fs-4 fw-bold ">Side dishes(<font color="red">*</font>)</p>
                            <p class="fs-6 fst-italic fw-lighter">Please select on of the properties below</p>
                            <div class="form-check">
                                <input class="form-check-input" style="background-color: blue;" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">
                                  Vegetables
                                </label>
                              </div>
                            <hr>
                            <button  class="btn btn-lg w-100 rounded-pill" id="addinorder" data-bs-dismiss="modal" style="background-color:#0d6efd; color: white;" onclick="order('`+Name+`', `+Price+`, './media/`+ImageLink+`',this.parentNode.childNodes[6].childNodes[3].childNodes[3]);">ADD into cart</button>
                        </div>
                    </div>`;
            
        }
        let increase = e => {
            e.parentNode.childNodes[3].innerHTML++;

        };
        let decrease = e => {
            if (e.parentNode.childNodes[3].innerHTML > 1)
                e.parentNode.childNodes[3].innerHTML--;
        };
        function order(itemname, itemprice, itemimage, parent) {
            quantity = parent.innerHTML;
            parent.innerHTML = 1;
            orderidarray.push(id);
            orderitemarray.push(itemname);
            orderimgarray.push(itemimage);
            orderarray.push(itemname, itemprice, itemimage);
            let orderlist = document.getElementById('orderlist');
            const orderitem = document.createElement('li');
            orderitem.className = "d-flex justify-content-between align-items-center";
            const orderitempricespan = document.createElement('span')
            const orderItemname = document.createTextNode(' ' + itemname + "   ");
            const ordersizespan = document.createElement('span')
            var sizeS = document.getElementById("flexCheckDefaultS").checked;   
            var sizeM = document.getElementById("flexCheckDefaultM").checked;
            var sizeL = document.getElementById("flexCheckDefaultL").checked;   
            let size = ""; 
            if ((sizeS && sizeM) || (sizeS && sizeL) || (sizeM && sizeL)) {
                alert("Please just choose one size");
                return;
            }
            else if (sizeS){
                size = " Size S ";
            }
            else if (sizeM){
                size = " Size M ";
            }
            else if (sizeL){
                size = " Size L ";
            }
            else {
                alert("You have not selected the size");
                return;
            }
            id++; console.log(id);
            const ordersize = document.createTextNode(size + '-');
            ordersizespan.className = 'text-danger';
            ordersizespan.appendChild(ordersize);
            if (sizeM){
                itemprice += 2;
            }
            else if (sizeL){
                itemprice += 4;
            }
            orderpricearray.push(itemprice);
            arrquantity.push(quantity);
            const orderprice = document.createTextNode('$' + itemprice.toFixed(2) + "    Quantity: " + quantity);
            orderitempricespan.className = 'text-danger';
            orderitempricespan.appendChild(orderprice);
